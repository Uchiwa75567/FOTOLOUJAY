<div class="camera-container">
  @if (errorMessage()) {
    <div class="camera-error">
      <div class="error-icon">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
      </div>
      <p class="error-message">{{ errorMessage() }}</p>
      <button (click)="startCamera()" class="btn btn-primary">Réessayer</button>
      <button (click)="cancel()" class="btn btn-outline">Annuler</button>
    </div>
  } @else if (capturedPhoto()) {
    <div class="photo-preview">
      <img [src]="capturedPhoto()" alt="Photo capturée" />
      <div class="preview-actions">
        <button (click)="retakePhoto()" class="btn btn-outline">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="1 4 1 10 7 10"></polyline>
            <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
          </svg>
          Reprendre
        </button>
        <button (click)="confirmPhoto()" class="btn btn-primary">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          Confirmer
        </button>
      </div>
    </div>
  } @else if (isInitializing()) {
    <div class="camera-loading">
      <div class="spinner"></div>
      <p>Initialisation de la caméra...</p>
    </div>
  } @else if (isCameraActive()) {
    <div class="camera-view">
      <video #video autoplay playsinline muted></video>
      <canvas #canvas style="display: none;"></canvas>
      <div class="camera-controls">
        <button (click)="cancel()" class="btn-cancel">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
        <button (click)="capturePhoto()" class="btn-capture">
          <div class="capture-ring">
            <div class="capture-button"></div>
          </div>
        </button>
        <div class="spacer"></div>
      </div>
    </div>
  } @else {
    <div class="camera-start">
      <div class="camera-icon">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
          <circle cx="12" cy="13" r="4"></circle>
        </svg>
      </div>
      <h3>Prêt à photographier ?</h3>
      <p>Capturez une photo de votre produit</p>
      <button (click)="startCamera()" class="btn btn-primary btn-lg">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
          <circle cx="12" cy="13" r="4"></circle>
        </svg>
        Ouvrir la caméra
      </button>
    </div>
  }
</div>